type: sections
max_columns: 3
title: Smart Energy System
path: smart-energy-system
icon: mdi:dots-circle
sections:
  - type: grid
    cards:
      - type: heading
        heading: EnergiflÃ¶de
        heading_style: subtitle
        icon: mdi:home-lightning-bolt
        badges: []
      - type: custom:energy-flow-card-plus
        entities:
          grid:
            entity:
              consumption: sensor.sem_import
              production: sensor.sem_export
          solar:
            entity: sensor.sem_solar_production
            display_zero_state: true
          battery:
            entity:
              consumption: sensor.batteries_day_discharge
              production: sensor.batteries_day_charge
          individual1:
            entity: sensor.sem_ev_charge
            name: Laddbox
            color: teal
        clickable_entities: false
        display_zero_lines: true
        use_new_flow_rate_model: false
        energy_date_selection: false
        wh_decimals: 2
        kwh_decimals: 1
        min_flow_rate: 1
        max_flow_rate: 6
        max_expected_energy: 2000
        min_expected_energy: 10
        wh_kwh_threshold: 1000
        grid_options:
          columns: 60
          rows: auto
        column_span: 2
      - type: heading
        heading: Systemets driftplan
        heading_style: subtitle
        icon: mdi:calendar-clock
        badges:
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.sem_nordpool_active
            name: Elpris
            icon: mdi:transmission-tower-import
            state_content:
              - name
              - state
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:apexcharts-card
            update_interval: 1 min
            graph_span: 48h
            cache: false
            span:
              start: day
              offset: +0H
            header:
              title: Systemets driftplan
              show: false
              show_states: false
              colorize_states: true
            hours_12: false
            stacked: false
            experimental:
              color_threshold: true
            yaxis:
              - id: spotpris
                opposite: false
                show: true
                decimals: 1
                min: 0
                apex_config:
                  title:
                    text: Elpris (SEK/kWh)
              - id: solar_power
                opposite: true
                show: true
                apex_config:
                  title:
                    text: Solel (kWh)
              - id: charge/expensive
                opposite: true
                show: false
            apex_config:
              chart:
                height: 320
                animations:
                  enabled: true
                  easing: easeinout
                  speed: 800
                  animateGradually:
                    enabled: true
                    delay: 150
              legend:
                show: true
                floating: false
                offsetY: 5
                position: bottom
                fontSize: 10px
              tooltip:
                enabled: true
              xaxis:
                labels:
                  show: true
                  rotate: 0
                  rotateAlways: true
                  logarithmic: false
                  datetimeUTC: false
              stroke:
                width: 1
              plotOptions:
                candlestick:
                  colors:
                    upward: "#00B746"
                    downward: "#EF403C"
                  wick:
                    useFillColor: true
            all_series_config:
              show:
                legend_value: false
                datalabels: false
                in_brush: false
              float_precision: 3
              invert: false
              fill_raw: last
            now:
              show: true
              label: NU
              color: red
            series:
              - entity: sensor.sem_solar_forecast
                yaxis_id: solar_power
                data_generator: >
                  return entity.attributes.sem.watt_hours_period.map((entry) =>
                  {
                    const value = entry.values / 1000;
                    if (value <= 0) {
                      return [new Date(entry.date), null];
                    }
                    return [new Date(entry.date), value];
                  });
                name: Solel
                extend_to: false
                type: area
                color: orange
                opacity: 0.7
                stroke_width: 3
                color_threshold:
                  - value: 0
                    color: "#fff9c4"
                  - value: 5
                    color: "#ffeb3b"
                  - value: 15
                    color: "#fbc02d"
              - entity: sensor.sem_nordpool_active
                yaxis_id: spotpris
                type: area
                name: Idag
                opacity: 0.7
                color: grey
                extend_to: false
                data_generator: >
                  const data = entity.attributes.raw_today.map((start, index) =>
                  {
                    return [new Date(start["start"]).getTime(), start["value"]];
                  });

                  const last = entity.attributes.raw_today.slice(-1)[0];

                  const lastTime = new Date(last["start"]).getTime();

                  data.push([lastTime + 3600000, last["value"]]); // 

                  return data;
                color_threshold:
                  - value: -1
                    color: 1E90FF
                  - value: 0.5
                    color: "008000"
                  - value: 1
                    color: DAA520
                  - value: 2
                    color: FF0000
                show:
                  legend_value: false
                  datalabels: false
                  extremas: true
                  in_brush: false
                  in_legend: false
              - entity: sensor.sem_nordpool_active
                yaxis_id: spotpris
                name: Imorgon
                type: area
                opacity: 0.7
                color: grey
                data_generator: >
                  const data = entity.attributes.raw_tomorrow.map((start, index)
                  => {
                    return [new Date(start["start"]).getTime(), start["value"]];
                  });

                  const last = entity.attributes.raw_tomorrow.slice(-1)[0];
                  const lastTime = new Date(last["start"]).getTime();

                  data.push([lastTime + 3600000, last["value"]]);

                  return data;
                color_threshold:
                  - value: -1
                    color: 1E90FF
                  - value: 0.5
                    color: "008000"
                  - value: 1
                    color: DAA520
                  - value: 2
                    color: FF0000
                show:
                  legend_value: false
                  datalabels: false
                  extremas: true
                  in_brush: false
                  in_legend: false
              - entity: sensor.sem_battery_cheap_interval_2_1a
                yaxis_id: charge/expensive
                name: VilolÃ¤ge
                opacity: 0.7
                color: "#D3D3D3"
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 0.75]);
                  data.push([startTime, 0.75]);
                  data.push([endTime, 0.75]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: true
              - entity: sensor.sem_battery_cheap_interval_1a_2
                yaxis_id: charge/expensive
                name: VilolÃ¤ge
                opacity: 0.7
                color: "#D3D3D3"
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 0.75]);
                  data.push([startTime, 0.75]);
                  data.push([endTime, 0.75]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: false
              - entity: sensor.sem_export_limit
                yaxis_id: charge/expensive
                name: BegrÃ¤nsar solexport
                opacity: 0.7
                color: BBCDDD
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 0.5]);
                  data.push([startTime, 0.5]);
                  data.push([endTime, 0.5]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: true
              - entity: sensor.sem_relative_expensive_price_1
                yaxis_id: charge/expensive
                name: Pristopp
                opacity: 0.7
                color: pink
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 0.7]);
                  data.push([startTime, 0.7]);
                  data.push([endTime, 0.7]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: true
              - entity: sensor.sem_relative_expensive_price_2
                yaxis_id: charge/expensive
                name: Pristopp
                opacity: 0.7
                color: pink
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 0.7]);
                  data.push([startTime, 0.7]);
                  data.push([endTime, 0.7]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: false
              - entity: sensor.sem_battery_charge_window_cheapest_1a
                yaxis_id: charge/expensive
                name: LaddningsfÃ¶nster
                opacity: 0.7
                color: "#00406c"
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 1]);
                  data.push([startTime, 1]);
                  data.push([endTime, 1]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: true
              - entity: sensor.sem_battery_charge_window_cheapest_2
                yaxis_id: charge/expensive
                name: LaddningsfÃ¶nster 2
                opacity: 0.7
                color: "#00406c"
                type: area
                data_generator: |
                  const data = [];
                  const sensorData = entity.state.split(' - ');
                  function parseLocalTime(str) {
                    const parts = str.split(/[- :T]/).map(Number);
                    const date = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4]);
                    return date.getTime();
                  }
                  const startTime = parseLocalTime(sensorData[0]);
                  const endTime = parseLocalTime(sensorData[1]);
                  data.push([startTime, 1]);
                  data.push([startTime, 1]);
                  data.push([endTime, 1]);
                  data.push([endTime, 0]);
                  return data;
                show:
                  legend_value: false
                  datalabels: false
                  extremas: false
                  in_brush: false
                  in_legend: false
        grid_options:
          columns: 24
          rows: auto
    column_span: 2
  - type: grid
    cards:
      - type: heading
        heading_style: subtitle
        heading: Ã–versikt
        icon: mdi:account-eye
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:gap-card
            height: 10
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - square: false
                    type: grid
                    cards:
                      - clock_style: analog
                        clock_size: small
                        show_seconds: true
                        no_background: false
                        border: false
                        ticks: hour
                        type: clock
                      - show_current: false
                        show_forecast: true
                        type: weather-forecast
                        entity: weather.smhi_home
                        forecast_type: daily
                        forecast_slots: 3
                        tap_action:
                          action: none
                        name: HEM
                    columns: 2
                view_layout:
                  position: sidebar
            view_layout:
              position: sidebar
          - type: tile
            entity: sensor.sem_house_power
            name: Huset
            icon: mdi:home
            color: blue-grey
            show_entity_picture: false
            hide_state: false
            vertical: false
            tap_action:
              action: navigate
              navigation_path: "#house"
            hold_action:
              action: navigate
              navigation_path: "#house"
            icon_tap_action:
              action: navigate
              navigation_path: "#house"
            features:
              - type: trend-graph
            features_position: bottom
          - square: false
            type: grid
            cards:
              - type: tile
                entity: sensor.power_meter_active_power
                name: ElnÃ¤tet
                icon: mdi:transmission-tower
                color: red
                vertical: false
                tap_action:
                  action: navigate
                  navigation_path: "#grid"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#grid"
                features_position: bottom
              - type: tile
                entity: sensor.sem_input_power_with_efficiency_loss_kw
                name: Solceller
                icon: mdi:solar-power-variant
                color: primary
                vertical: false
                tap_action:
                  action: navigate
                  navigation_path: "#solar"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#solar"
                features_position: inline
              - type: conditional
                conditions:
                  - condition: state
                    entity: sensor.sem_wallbox_check
                    state: "True"
                card:
                  type: tile
                  entity: sensor.sem_ev_sensor_power
                  name: Elbil
                  icon: mdi:ev-plug-type2
                  color: blue
                  vertical: false
                  tap_action:
                    action: navigate
                    navigation_path: "#wallbox"
                  icon_tap_action:
                    action: navigate
                    navigation_path: "#wallbox"
                  features_position: inline
          - type: tile
            entity: sensor.batteries_charge_discharge_power
            name: Batteriet
            icon: mdi:battery-charging-100
            color: indigo
            vertical: false
            tap_action:
              action: navigate
              navigation_path: "#battery"
            icon_tap_action:
              action: navigate
              navigation_path: "#battery"
            features:
              - type: trend-graph
            features_position: inline
          - square: false
            type: grid
            cards:
              - type: tile
                entity: sensor.sem_battery_mode
                name: ArbetslÃ¤ge
                icon: mdi:auto-mode
                color: indigo
                hide_state: false
                vertical: false
                tap_action:
                  action: navigate
                  navigation_path: "#battery"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#battery"
                features_position: bottom
              - type: tile
                entity: sensor.batteries_state_of_capacity
                name: NivÃ¥
                icon: mdi:battery
                color: indigo
                show_entity_picture: false
                hide_state: false
                vertical: false
                tap_action:
                  action: navigate
                  navigation_path: "#battery"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#battery"
                features_position: inline
            columns: 2
        view_layout:
          position: sidebar
      - type: heading
        heading_style: subtitle
        heading: Kontrollpanel
        icon: mdi:cog
      - square: false
        type: grid
        cards:
          - type: tile
            grid_options:
              columns: 12
              rows: 1
            entity: input_button.sem_settings_fast
            name: Snabbval
            icon: mdi:order-bool-descending
            color: primary
            show_entity_picture: false
            hide_state: true
            vertical: true
            tap_action:
              action: navigate
              navigation_path: "#settings_fast"
            hold_action:
              action: navigate
              navigation_path: "#settings_fast"
            icon_tap_action:
              action: navigate
              navigation_path: "#settings_fast"
            features_position: bottom
          - type: tile
            grid_options:
              columns: 12
              rows: 1
            entity: input_button.sem_settings
            name: Mitt system
            icon: mdi:account
            color: primary
            hide_state: true
            vertical: true
            tap_action:
              action: navigate
              navigation_path: "#settings"
            hold_action:
              action: navigate
              navigation_path: "#settings"
            icon_tap_action:
              action: navigate
              navigation_path: "#settings"
            features_position: bottom
        columns: 2
      - type: heading
        heading_style: subtitle
        heading: NÃ¤sta laddning
        icon: mdi:battery-clock
      - type: custom:vertical-stack-in-card
        cards:
          - type: conditional
            conditions: []
            card:
              type: conditional
              conditions:
                - condition: state
                  entity: sensor.sem_battery_charging_interval_next
                  state: "2"
              card:
                type: custom:vertical-stack-in-card
                cards:
                  - type: markdown
                    content: |2+
                        {% set interval = states('sensor.sem_battery_charge_window_cheapest_2') %}
                        {% set energy = states('sensor.sem_battery_charge_energy_2_1b') %}
                        {% if ' - ' in interval %}
                          {% set start_str, end_str = interval.split(' - ') %}
                          {% set start_time = start_str | as_datetime %}
                          {% set end_time = end_str | as_datetime %}
                          {% set supercheap = state_attr('sensor.sem_battery_charge_energy_2_1b','supercheap_charge') %}
                          
                          ğŸ•›Klockan: {{ start_time.strftime('%H:%M') }} - {{ end_time.strftime('%H:%M')}}{% set sc = state_attr('sensor.sem_battery_charge_energy_2_1b', 'should_charge') %}{% if sc == true%}
                          âš¡Laddningsbeslut: Ladda{% else %}
                        âŒ Laddningsbeslut: Ladda ej {% endif %}
                        ğŸ”‹BerÃ¤knad laddning: {{ energy }} kWh
                        ğŸ’°Extra superbillig laddning: {{ supercheap }} kWh
                        {% if is_state('input_boolean.sem_interval_2', 'on') %} âœ…Status: Laddar {% else %} ğŸ’¤Status: Inaktiv {% endif %}
                        {% else %}
                          Ingen tid tillgÃ¤nglig  
                        {% endif %}

            grid_options:
              columns: 12
              rows: 1
            view_layout:
              position: sidebar
          - type: conditional
            conditions: []
            card:
              type: conditional
              conditions:
                - condition: state
                  entity: sensor.sem_battery_charging_interval_next
                  state: "1"
              card:
                type: custom:vertical-stack-in-card
                cards:
                  - type: markdown
                    content: >-
                      {% set interval =
                      states('sensor.sem_battery_charge_window_cheapest_1a') %}
                        {% set energy = states('sensor.sem_battery_charge_energy_1a_2') %}
                        {% if ' - ' in interval %}
                          {% set start_str, end_str = interval.split(' - ') %}
                          {% set start_time = start_str | as_datetime %}
                          {% set end_time = end_str | as_datetime %}
                          {% set supercheap = state_attr('sensor.sem_battery_charge_energy_1a_2','supercheap_charge') %}
                          ğŸ•Klockan: {{ start_time.strftime('%H:%M') }} - {{ end_time.strftime('%H:%M') }}</b> 
                      {% set sc =
                      state_attr('sensor.sem_battery_charge_energy_1a_2',
                      'should_charge') %}{% if sc == true%}âš¡Laddningsbeslut:
                      Ladda{% else %} âŒ Laddningsbeslut: Ladda ej {% endif %}
                          ğŸ”‹BerÃ¤knad laddning: {{ energy }} kWh
                          ğŸ’°Extra superbillig laddning: {{ supercheap }} kWh
                          {% if is_state('input_boolean.sem_interval_1a', 'on') %} âœ…Status: Laddar {% else %} ğŸ’¤Status: Inaktiv {% endif %}
                        {% else %}
                          Ingen tid tillgÃ¤nglig  
                        {% endif %}
            view_layout:
              position: sidebar
  - type: grid
    cards:
      - type: vertical-stack
        cards:
          - type: heading
            icon: mdi:account
            heading: Mitt system
            heading_style: title
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#settings"
            show_header: false
            background_update: false
            width_desktop: 600px
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:text-box
                heading_style: subtitle
                heading: Version
              - type: tile
                entity: sensor.sem_version
                name: Installerad version
                icon: mdi:laptop
                vertical: false
                tap_action:
                  action: none
                icon_tap_action:
                  action: none
                features_position: bottom
              - type: tile
                entity: sensor.sem_github_latest_release
                name: Senaste version pÃ¥ Github
                icon: mdi:github
                vertical: false
                tap_action:
                  action: none
                icon_tap_action:
                  action: none
                features_position: bottom
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.manual_update_packages
                state: "off"
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: heading
                  icon: mdi:update
                  heading: Uppdatera
                  heading_style: subtitle
                - type: tile
                  entity: input_boolean.manual_update_packages
                  name: Uppdatera
                  icon: mdi:cloud-download
                  color: indigo
                  hide_state: true
                  vertical: true
                  tap_action:
                    action: toggle
                  icon_tap_action:
                    action: toggle
                  features_position: bottom
                - type: markdown
                  content: >-
                    **â„¹ï¸Information**

                    Uppdatera systemet genom att klicka pÃ¥ uppdatera. DÃ¥ laddas
                    och installeras den senste versionen. **Starta om Home
                    Assistant efter installationen.**
                  text_only: true
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.sem_download
                state: "on"
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: heading
                  icon: mdi:update
                  heading: Uppdatera
                  heading_style: subtitle
                - type: tile
                  entity: input_boolean.sem_download
                  name: VÃ¤nligen vÃ¤nta ...
                  icon: mdi:clock-time-eight-outline
                  color: amber
                  hide_state: true
                  vertical: true
                  tap_action:
                    action: none
                  icon_tap_action:
                    action: none
                  features_position: bottom
                - type: markdown
                  content: >-
                    **â„¹ï¸Information**

                    Den senaste versionen laddas hem och installeras - VÃ¤nligen
                    vÃ¤nta ...
                  text_only: true
          - type: conditional
            conditions:
              - condition: state
                entity: input_boolean.sem_download_finished
                state: "on"
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: heading
                  icon: mdi:update
                  heading: Uppdatera
                  heading_style: subtitle
                - type: tile
                  entity: input_boolean.sem_download_finished
                  name: FÃ¤rdigt
                  icon: mdi:check-circle-outline
                  color: green
                  hide_state: true
                  vertical: true
                  tap_action:
                    action: none
                  icon_tap_action:
                    action: none
                  features_position: bottom
                - type: markdown
                  content: >-
                    **â„¹ï¸Information**

                    Uppdateringen fÃ¤rdig âœ… 


                    FÃ¶r att slutfÃ¶ra mÃ¥ste du starta om Home Assistant. 


                    ğŸ’» Uppdatera Ã¤ven hemvyn genom att klistra in koden frÃ¥n
                    filen admin_view via github. 
                  text_only: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:account-cog
                heading: "Konfigurera "
                heading_style: subtitle
              - type: tile
                entity: input_button.sem_config_1
                name: Konfiguera
                icon: mdi:cog
                color: green
                hide_state: true
                vertical: true
                tap_action:
                  action: navigate
                  navigation_path: "#config_1"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#config_1"
                features_position: bottom
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Anpassa systemet till din anlÃ¤ggning och din plats. Observera
                  att systemet behÃ¶ver minst **sju dagar** fÃ¶r att
                  energiberÃ¤kningarna ska stÃ¥ i relation till  verkligheten.   
                text_only: true
          - type: heading
            icon: mdi:face-agent
            heading_style: title
            heading: Support
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:account-tag
                heading: AnvÃ¤ndarkod
                heading_style: subtitle
              - type: tile
                entity: input_button.sem_buy_key
                name: KÃ¶p anvÃ¤ndarkod
                icon: mdi:key-chain-variant
                color: deep-orange
                hide_state: true
                vertical: true
                tap_action:
                  action: navigate
                  navigation_path: "#buy_key"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#buy_key"
                features_position: bottom
              - type: markdown
                content: >-
                  **â„¹ï¸Information**  

                  KÃ¶p din anvÃ¤ndarkod genom att klicka pÃ¥ knappen **kÃ¶p
                  anvÃ¤ndarkod**.
                text_only: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:code-json
                heading_style: subtitle
                heading: Kontakta utvecklaren
              - type: markdown
                content: >-
                  ğŸª²[AnmÃ¤l ett
                  fel](https://github.com/Henrik1986/huawei-energy-managment/issues)
                  pÃ¥ Github. 

                  âœ¨Ã–nska [ny
                  funktion](https://github.com/Henrik1986/huawei-energy-managment/discussions)
                  pÃ¥ Github
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#buy_key"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              action: navigate
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:key-chain
                heading: KÃ¶p anvÃ¤ndarkod
                heading_style: title
              - type: markdown
                content: >-
                  **Hej,**


                  Kul att du vill prova mitt paket fÃ¶r att styra ditt
                  Huawei-system.

                  Detta Ã¤r ett hobbyprojekt, men fÃ¶r att kunna vidareutveckla
                  systemet och erbjuda ett modernt och lokalt sÃ¤tt att styra
                  ditt Huawei-system krÃ¤vs en anvÃ¤ndarkod. Priset Ã¤r **399 kr
                  per Ã¥r.**


                  FÃ¶r att fÃ¥ en anvÃ¤ndarkod fyller du i fÃ¶r- och efternamn samt
                  din epost och klickar pÃ¥ ansÃ¶k. NÃ¤r jag fÃ¥tt din ansÃ¶kan
                  kommer jag hÃ¶ra av mig till dig. 


                  Ã„r du osÃ¤ker pÃ¥ om paketet passar dig? DÃ¥ kan du fÃ¥ en demokod
                  som gÃ¤ller i 30 dagar. 


                  VÃ¤nligen,

                  Henrik
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_submit_user_info
                    state: "off"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: heading
                      icon: mdi:form-select
                      heading: AnsÃ¶k om anvÃ¤ndarkod
                      heading_style: subtitle
                    - type: conditional
                      conditions:
                        - condition: state
                          entity: input_boolean.sem_submit_user_info
                          state: "off"
                      card:
                        type: entities
                        entities:
                          - entity: input_text.sem_name
                            name: FÃ¶r- och efternamn
                            icon: mdi:account
                          - entity: input_text.sem_epost
                            icon: mdi:email
                    - type: tile
                      entity: input_boolean.sem_submit_user_info
                      name: AnsÃ¶k
                      icon: mdi:email-fast
                      hide_state: true
                      vertical: true
                      features_position: bottom
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_submit_user_info
                    state: "on"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: heading
                      icon: mdi:check-circle
                      heading: Din ansÃ¶kan Ã¤r inskickad
                      heading_style: title
                    - type: markdown
                      content: >-
                        Vidare instruktioner kommer att skickas till din angivna
                        epost. Tack fÃ¶r att du stÃ¶ttar mitt arbete. 


                        VÃ¤nligen, 

                        Henrik
                      text_only: true
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#settings_fast"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: heading
            icon: mdi:order-bool-descending
            heading: Snabbval
            heading_style: title
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: "Ladda manuellt "
              - type: entities
                entities:
                  - entity: input_number.sem_max_charge_manual_charging
                    name: Laddningseffekt
                    icon: mdi:lightning-bolt-circle
                    secondary_info: none
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
                  - entity: input_number.sem_manual_charge_duration
                    icon: mdi:clock
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
                  - entity: input_boolean.sem_manual_charge
                    icon: mdi:power-plug-battery
                    name: Ladda nu
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
                show_header_toggle: false
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Under **ladda manuellt** kan du starta en laddning pÃ¥ egen
                  hand. VÃ¤lj laddningseffekt och tid fÃ¶r att sen aktivera
                  laddningen genom reglaget pÃ¥ **ladda nu**.
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: Extra kWh
              - type: entities
                entities:
                  - entity: input_number.extra_1
                    name: TillfÃ¤lle 1 (9-16)
                    icon: mdi:battery-plus
                    secondary_info: none
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
                  - entity: input_number.extra_2
                    name: TillfÃ¤lle 2 (23-05)
                    icon: mdi:battery-plus
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Under **extra kWh** kan du lÃ¤gga till extra kWh pÃ¥ ett
                  laddningstillfÃ¤lle. Detta kan vara anvÃ¤ndbart om du vill ladda
                  mer Ã¤n vad systemet fÃ¶reslÃ¥r. 
  - type: grid
    cards:
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_1"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: title
                heading: Konfiguration
              - type: picture-elements
                elements: []
                image: /api/image/serve/e83b35c09064e00c5f35034371a70519/512x512
                style:
                  top: 5%
                  left: 5%
                  width: 3%
              - type: entities
                entities:
                  - entity: input_text.sem_user_access_code
                    tap_action:
                      action: nothing
                    icon_tap_action:
                      action: nothing
              - type: markdown
                content: >+
                  {% set user_code = states('input_text.sem_user_access_code') |
                  trim %}

                  {% set codes_raw = states('sensor.sem_sys_state') %}

                  {% set codes_list = codes_raw.split(',') | map('trim') | list
                  %}

                  {% if user_code in codes_list %}
                    **AnvÃ¤ndarID**
                    âœ… OK
                  {% else %}
                    **AnvÃ¤ndarID**
                    âŒ Ogiltlig kod
                  {% endif %}



                  {# Lista Ã¶ver entiteter att kontrollera #}

                  {% set e1 = 'sensor.batteries_state_of_capacity' %}

                  {% set e2 = 'input_number.sem_batteries_end_of_discharge_soc'
                  %}

                  {% set e3 = 'sensor.inverter_input_power' %}

                  {% set e4 = 'sensor.power_meter_active_power' %}

                  {% set e5 = 'sensor.batteries_charge_discharge_power' %}

                  {% set e6 = 'select.batteries_working_mode' %}


                  {# HÃ¤mta states #}

                  {% set s1 = states(e1) %}

                  {% set s2 = states(e2) %}

                  {% set s3 = states(e3) %}

                  {% set s4 = states(e4) %}

                  {% set s5 = states(e5) %}

                  {% set s6 = states(e6) %}


                  {# Definiera vad som rÃ¤knas som otillgÃ¤ngligt #}

                  {% set bad = ['unknown', 'unavailable', '', None] %}


                  {# RÃ¤kna antal otillgÃ¤ngliga utan append() #}

                  {% set cnt = ((s1 in bad) | int) + ((s2 in bad) | int) + ((s3
                  in bad) | int) + ((s4 in bad) | int) + ((s5 in bad) | int) +
                  ((s6 in bad) | int) %}


                  {# Utdatat: endast otillgÃ¤ngliga enheter #}

                  {% if cnt == 0 %}

                  **Huawei**

                  âœ… OK

                  {% else %}

                  **Huawei**

                  âŒ Enheter saknas eller har felaktigt namn ({{ cnt }})

                  {% if s1 in bad %}- {{ e1 }} {% endif %}

                  {% if s2 in bad %}- {{ e2 }} {% endif %}

                  {% if s3 in bad %}- {{ e3 }} {% endif %}

                  {% if s4 in bad %}- {{ e4 }} {% endif %}

                  {% if s5 in bad %}- {{ e5 }} {% endif %}

                  {% if s6 in bad %}- {{ e6 }} {% endif %}

                  {% endif %}


                  {% if states('weather.smhi_home') not in ['unknown',
                  'unavailable', ''] %}

                  **SMHI**
                    âœ… OK
                  {% else %}

                  **SMHI**
                    âŒ weather.smhi_home saknas
                  {% endif %}


                  {% if integration_entities('nordpool') | count > 0 %}

                  **Nordpool**
                    âœ… OK
                  {% else %}

                  **Nordpool**
                    âŒ Nordpool saknas
                  {% endif %}


                  {% set missing = [] %}


                  {% if states('sensor.sem_hacs_apexcharts_card') != 'OK' %}
                    {% set missing = missing + ['ApexCharts Card'] %}
                  {% endif %}


                  {% if states('sensor.sem_hacs_bubble_card') != 'OK' %}
                    {% set missing = missing + ['Bubble Card'] %}
                  {% endif %}


                  {% if states('sensor.sem_hacs_energy_flow_card_plus') != 'OK'
                  %}
                    {% set missing = missing + ['Energy Flow Card Plus'] %}
                  {% endif %}


                  {% if states('sensor.sem_hacs_lovelace_layout_card') != 'OK'
                  %}
                    {% set missing = missing + ['Lovelace Layout Card'] %}
                  {% endif %}


                  {% if states('sensor.sem_hacs_vertical_stack_in_card') != 'OK'
                  %}
                    {% set missing = missing + ['Vertical Stack In Card'] %}
                  {% endif %}

                  **HACS**

                  {{ 'âœ… OK' if missing | length == 0 else 'âŒ Saknas: ' ~
                  (missing | join(', ')) }}



                  **âš ï¸ VARNING!**

                  Detta Ã¤r ett hobbyprojekt â€“ anvÃ¤nd pÃ¥ eget ansvar. 

              - type: tile
                entity: input_button.sem_config_2
                name: Starta konfigurationen
                icon: mdi:arrow-right
                color: green
                hide_state: true
                vertical: true
                tap_action:
                  action: navigate
                  navigation_path: "#config_2"
                icon_tap_action:
                  action: navigate
                  navigation_path: "#config_2"
                features_position: bottom
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_2"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: title
                heading: Generell information
              - type: heading
                icon: ""
                heading: Nordpool
                heading_style: subtitle
              - type: tile
                entity: input_boolean.sem_use_official_nordpool
                name: Officiella integrationen
                icon: mdi:dots-horizontal
                color: green
                hide_state: true
                vertical: false
                tap_action:
                  action: none
                icon_tap_action:
                  action: none
                features:
                  - type: toggle
                features_position: inline
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_use_official_nordpool
                    state: "off"
                card:
                  type: markdown
                  content: >-
                    **â„¹ï¸Information**

                    Aktivera reglaget om du anvÃ¤nder den officiella
                    integrationen â€“ annars lÃ¤mna det avstÃ¤ngt.
                  text_only: true
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_use_official_nordpool
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_text.sem_nordpool_config_entry_official
                          name: Config Entry
                          tap_action:
                            action: none
                          icon_tap_action:
                            action: none
                        - entity: input_text.sem_nordpool_area_official
                          name: Ditt elomrÃ¥de
                          tap_action:
                            action: none
                          icon_tap_action:
                            action: none
                    - type: markdown
                      content: >
                        **â„¹ï¸Information**

                        Du hittar config entry sÃ¥ hÃ¤r: 

                        Utvecklarverktyg - Ã…tgÃ¤rder - klicka pÃ¥ gÃ¥ ill UI-lÃ¤get
                        - VÃ¤lj nordpool.get_prices under Ã¥tgÃ¤rd - klicka pÃ¥ gÃ¥
                        till yaml-lÃ¤ge.
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_use_official_nordpool
                    state: "off"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_text.sem_nordpool_sensor_inofficial
                          name: Din inofficiella Nordpool sensor
                          tap_action:
                            action: none
                          icon_tap_action:
                            action: none
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: Huawei batteri ID
              - type: entities
                entities:
                  - entity: input_text.sem_device_id
                    tap_action:
                      action: none
                    icon_tap_action:
                      action: none
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ditt Huawei batteri ID: 

                  Utvecklarverktyg -> Ã…tgÃ¤rder -> Klicka pÃ¥ Ã¥tgÃ¤rd -> Skriv
                  huawei -> VÃ¤lj forcible charge -> Klicka pÃ¥ gÃ¥ till UI-lÃ¤ge ->
                  VÃ¤lj Batteries i rullgardinen pÃ¥ raden battery -> Klicka pÃ¥ gÃ¥
                  till YAML-lÃ¤ge 
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: Huawei inverter ID
              - type: entities
                entities:
                  - entity: input_text.sem_device_id_inverter
                    tap_action:
                      action: none
                    icon_tap_action:
                      action: none
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ditt Huawei inverter ID: 

                  Utvecklarverktyg -> Ã…tgÃ¤rder -> Klicka pÃ¥ Ã¥tgÃ¤rd -> Skriv
                  huawei -> VÃ¤lj limit the power fed to grid -> Klicka pÃ¥ gÃ¥
                  till UI-lÃ¤ge -> VÃ¤lj Inverter i rullgardinen pÃ¥ raden inverter
                  -> Klicka pÃ¥ gÃ¥ till YAML-lÃ¤ge 
              - type: heading
                heading_style: subtitle
                heading: VÃ¤derprognos
              - type: entities
                entities:
                  - entity: input_text.sem_weather_sensor
                    name: Din SMHI sensor
                    icon: mdi:weather-partly-cloudy
                    tap_action:
                      action: none
                    icon_tap_action:
                      action: none
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Du kan anvÃ¤nda din befintliga vÃ¤rder sensor frÃ¥n SMHI, men dÃ¥
                  fÃ¥r du Ã¤ndra vÃ¤rderkortet i hemvyn. AnvÃ¤nd weather.smhi_home
                  fÃ¶r att slippa Ã¤ndra i hemvyn. Om du inte redan skapa en ny
                  vÃ¤dersensor kan det vara bra att gÃ¶ra det nu. 
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: input_boolean.sem_step_0
                    name: Tillbaka
                    icon: mdi:arrow-left
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_1"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_1"
                    features_position: bottom
                  - type: tile
                    entity: input_boolean.sem_step_1
                    name: FortsÃ¤tt
                    icon: mdi:arrow-right
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_3"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_3"
                    features_position: bottom
                columns: 2
              - type: markdown
                content: |
                  <center> 1 av 4 </center>
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_3"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:solar-power-variant
                heading_style: title
                heading: Solceller
              - type: heading
                icon: ""
                heading: Din plats
                heading_style: subtitle
              - type: entities
                entities:
                  - entity: input_number.sem_solar_lat
                    name: Latitud
                    icon: mdi:earth
                  - entity: input_number.sem_solar_lon
                    icon: mdi:earth
                    name: Longitud
              - type: markdown
                content: |-
                  **â„¹ï¸Information**
                  Latitud: sÃ¶der= -90 och norr= 90.
                  Longitud: vÃ¤st= -180 och Ã¶st= 180. 
                  https://www.gps-coordinates.net/ 
              - type: tile
                entity: input_boolean.sem_solar_2
                name: TvÃ¥ anlÃ¤ggningar
                icon: mdi:solar-power
                color: green
                hide_state: true
                vertical: false
                tap_action:
                  action: toggle
                features:
                  - type: toggle
                features_position: inline
              - type: heading
                icon: ""
                heading: "Din installation "
                heading_style: subtitle
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_solar_2
                    state: "off"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: heading
                      icon: mdi:solar-panel
                      heading: AnlÃ¤ggning 1
                      heading_style: subtitle
                    - type: conditional
                      conditions:
                        - condition: state
                          entity: input_boolean.sem_solar_2
                          state: "off"
                      card:
                        type: entities
                        entities:
                          - entity: input_number.sem_solar_dec
                            name: Lutning
                            icon: mdi:angle-acute
                          - entity: input_number.sem_solar_az
                            name: Riktning
                            icon: mdi:compass
                          - entity: input_number.sem_solar_kwp
                            name: Kapacitet
                            icon: mdi:solar-panel
                    - type: heading
                      icon: ""
                      heading: DÃ¤mpingsfaktor
                      heading_style: subtitle
                    - type: entities
                      entities:
                        - entity: input_number.sem_solar_damping_morning
                          icon: mdi:weather-sunset-up
                          name: Morgon
                        - entity: input_number.sem_solar_damping_evening
                          icon: mdi:weather-sunset-down
                          name: KvÃ¤ll
                    - type: markdown
                      content: >-
                        **â„¹ï¸Information**

                        Lutning

                        0Â° = helt plant (horisontellt)

                        90Â° = rakt upp (vertikalt)


                        Riktning 

                        180Â° = norr

                        -90Â° = Ã¶st

                        0Â° = syd

                        90Â° = vÃ¤st


                        Kapacitet (kWp)

                        Den totala installerade effekten fÃ¶r panelgruppen.

                        LÃ¤s mer: https://doc.forecast.solar/api:estimate


                        Om laddningen frÃ¥n solen underskattas hÃ¶j vÃ¤rdet. Om
                        laddningen Ã¶verskattas sÃ¤nk vÃ¤rdet


                        Rekommenderat startvÃ¤rde: 0.6

                        LÃ¤s mer: https://doc.forecast.solar/damping
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_solar_2
                    state: "on"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: heading
                      icon: mdi:solar-panel
                      heading: AnlÃ¤ggning 1
                      heading_style: subtitle
                    - type: entities
                      entities:
                        - entity: input_number.sem_solar_dec
                          name: Lutning
                          icon: mdi:angle-acute
                        - entity: input_number.sem_solar_az
                          name: Riktning
                          icon: mdi:compass
                        - entity: input_number.sem_solar_kwp
                          name: Kapacitet
                          icon: mdi:solar-panel
                    - type: heading
                      icon: ""
                      heading: DÃ¤mpingsfaktor
                      heading_style: subtitle
                    - type: entities
                      entities:
                        - entity: input_number.sem_solar_damping_morning
                          icon: mdi:weather-sunset-up
                          name: Morgon
                        - entity: input_number.sem_solar_damping_evening
                          icon: mdi:weather-sunset-down
                          name: KvÃ¤ll
                    - type: divider
                    - type: heading
                      icon: mdi:solar-panel
                      heading: AnlÃ¤ggning 2
                      heading_style: subtitle
                    - type: entities
                      entities:
                        - entity: input_number.sem_solar_dec_2
                          name: Lutning
                          icon: mdi:angle-acute
                        - entity: input_number.sem_solar_az_2
                          name: Riktning
                          icon: mdi:compass
                        - entity: input_number.sem_solar_kwp_2
                          name: Kapacitet
                          icon: mdi:solar-panel
                    - type: heading
                      icon: ""
                      heading: DÃ¤mpingsfaktor
                      heading_style: subtitle
                    - type: entities
                      entities:
                        - entity: input_number.sem_solar_damping_morning_2
                          icon: mdi:weather-sunset-up
                          name: Morgon
                        - entity: input_number.sem_solar_damping_evening_2
                          icon: mdi:weather-sunset-down
                          name: KvÃ¤ll
                    - type: markdown
                      content: >-
                        **â„¹ï¸Information**

                        Lutning

                        0Â° = helt plant (horisontellt)

                        90Â° = rakt upp (vertikalt)


                        Riktning 

                        180Â° = norr

                        -90Â° = Ã¶st

                        0Â° = syd

                        90Â° = vÃ¤st


                        Kapacitet (kWp)

                        Den totala installerade effekten fÃ¶r panelgruppen.

                        LÃ¤s mer: https://doc.forecast.solar/api:estimate


                        Om laddningen frÃ¥n solen underskattas hÃ¶j vÃ¤rdet. Om
                        laddningen Ã¶verskattas sÃ¤nk vÃ¤rdet


                        Rekommenderat startvÃ¤rde: 0.6

                        LÃ¤s mer: https://doc.forecast.solar/damping
              - type: markdown
                content: >-
                  **âš ï¸ VARNING!**

                  Det publika API:et tillÃ¥ter max 12 anrop per rullande timme. I
                  denna setup gÃ¶rs endast ett anrop per timme.
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: input_boolean.sem_step_1
                    name: Tillbaka
                    icon: mdi:arrow-left
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_2"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_2"
                    features_position: bottom
                  - type: tile
                    entity: input_boolean.sem_step_2
                    name: FortsÃ¤tt
                    icon: mdi:arrow-right
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_4"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_4"
                    features_position: bottom
                columns: 2
              - type: markdown
                content: |
                  <center> 2 av 4 </center>
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_4"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: title
                heading: Smart styrning 1/2
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: Batteri och laddning
              - type: entities
                entities:
                  - entity: input_number.sem_battery_total_capacity_kwh
                    name: Total kapacitet
                    icon: mdi:battery
                  - entity: input_number.sem_max_charge_power_window_1
                    name: Laddningseffekt (9-16)
                    icon: mdi:flash
                  - entity: input_number.sem_max_charge_power_window_2
                    name: Laddningseffekt (23-05)
                    icon: mdi:flash
                  - entity: input_number.sem_max_charge_manual_charging
                    name: Manuell laddningseffekt
                    icon: mdi:flash
                  - entity: input_number.sem_battery_discharge_power_ev_limit
                    name: Max urladdningseffekt
                    icon: mdi:flash
                  - entity: input_number.sem_charge_profit_threshold
                    name: Laddningsvinst
                    icon: mdi:finance
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ange din totala lagringskapacitet under **total kapacitet**.
                  Ange den maximala tillÃ¥tna **laddningseffekt** vid de olika
                  laddningstillfÃ¤llena. **Laddningsvinst** styr grÃ¤nsvÃ¤rdet fÃ¶r
                  att laddningen genomfÃ¶ras. Detta hindrar att batteriet laddas
                  dÃ¥ elpriset Ã¤r jÃ¤mnt. 
              - type: entities
                entities:
                  - entity: input_number.sem_price_limit_supercheap
                    name: Superbilligt
                    icon: mdi:finance
                  - entity: input_number.sem_low_price_threshold
                    name: LÃ¥gt elpris
                    icon: mdi:finance
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ange grÃ¤nsen fÃ¶r vad som rÃ¤knas som **superbillig el**. Detta
                  vÃ¤rde anvÃ¤nds fÃ¶r att ladda batteriet extra nÃ¤r elpriset Ã¤r
                  vÃ¤ldigt lÃ¥gt. **LÃ¥gt elpris** avgÃ¶r grÃ¤svÃ¤rdet dÃ¥ batteriet
                  sÃ¤tts i vilolÃ¤ge och elen kÃ¶ps frÃ¥n elnÃ¤tet fÃ¶r att spara pÃ¥
                  batteriet. 
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: SÃ¤lja
              - features:
                  - type: toggle
                type: tile
                features_position: inline
                vertical: false
                entity: input_boolean.sem_discharge_high_prices
                name: SÃ¤lj batteriÃ¶verskott
                icon: mdi:transmission-tower-export
                tap_action:
                  action: toggle
                icon_tap_action:
                  action: toggle
                color: green
                hide_state: true
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_discharge_high_prices
                    state: "on"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.sem_max_export_power
                          name: Urladdningseffekt
                          icon: mdi:flash
                        - entity: input_number.sem_battery_discharge_power_ev_limit
                          name: Ã…terstÃ¤llningseffekt
                          icon: mdi:flash
                        - entity: input_number.sem_expensive_electricity
                          icon: mdi:finance
                          name: SÃ¤ljgrÃ¤ns
                        - entity: input_number.sem_battery_charge_price
                          name: LaddgrÃ¤ns
                          icon: mdi:finance
                    - type: markdown
                      content: >-
                        **â„¹ï¸Information**

                        **Urladdningseffekt** styr vilken effekt batteriet ska
                        kunna exportera el. **Ã…terstÃ¤llningseffekt** anger
                        vilken effekt batteriet ska Ã¥tergÃ¥ till efter export.
                        **SÃ¤ljgrÃ¤ns** anger hur hÃ¶gt elpriset mÃ¥ste vara fÃ¶r att
                        batteriet ska sÃ¤lja sitt Ã¶verskott. **LaddgrÃ¤ns** anger
                        elprisnivÃ¥n fÃ¶r nÃ¤sta laddning. BÃ¥da villkoren mÃ¥ste
                        uppfyllas fÃ¶r att batteriet ska sÃ¤lja Ã¶verskott.
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_discharge_high_prices
                    state: "off"
                card:
                  type: markdown
                  content: >-
                    **â„¹ï¸Information**

                    Aktivera **sÃ¤lj batteriÃ¶verskott** om du vill sÃ¤lja
                    batteriets Ã¶verskott. 
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: input_boolean.sem_step_2
                    name: Tillbaka
                    icon: mdi:arrow-left
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_3"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_3"
                    features_position: bottom
                  - type: tile
                    entity: input_boolean.sem_step_3
                    name: FortsÃ¤tt
                    icon: mdi:arrow-right
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_5"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_5"
                    features_position: bottom
                columns: 2
              - type: markdown
                content: |
                  <center> 3 av 4 </center>
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_5"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: title
                heading: Smart styrning 2/2
              - type: heading
                icon: ""
                heading: Export av solÃ¶verskottet
                heading_style: subtitle
              - type: tile
                entity: input_boolean.sem_export_limit_active
                features_position: inline
                vertical: false
                name: BegrÃ¤nsa export
                icon: mdi:transmission-tower-export
                hide_state: true
                color: green
                tap_action:
                  action: toggle
                icon_tap_action:
                  action: toggle
                features:
                  - type: toggle
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Aktivera reglaget om du vill att export av solel automatiskt
                  ska stoppas nÃ¤r elpriset Ã¤r 0 eller lÃ¤gre.
              - type: heading
                icon: ""
                heading_style: subtitle
                heading: Laddbox och elbil
              - type: tile
                entity: input_boolean.sem_ev_wallbox_multi
                name: TvÃ¥ laddboxar
                icon: mdi:checkbox-multiple-blank
                color: green
                hide_state: true
                vertical: false
                features:
                  - type: toggle
                features_position: inline
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_ev_wallbox_multi
                    state: "on"
                card:
                  type: entities
                  entities:
                    - entity: input_text.sem_ev_sensor
                      icon: mdi:ev-plug-type2
                      name: Laddbox 1
                    - entity: input_text.sem_ev_sensor_2
                      icon: mdi:ev-plug-type2
                      name: Laddbox 2
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_ev_wallbox_multi
                    state: "off"
                card:
                  type: entities
                  entities:
                    - entity: input_text.sem_ev_sensor
                      icon: mdi:ev-plug-type2
                      name: Laddbox 1
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ange namnet pÃ¥ sensorn som mÃ¤ter effekten pÃ¥ din laddbox. Fyll
                  i fÃ¶rsta fÃ¤ltet om du har tvÃ¥ laddboxar. Har du tvÃ¥ laddboxar
                  fyller du Ã¤ven i andra fÃ¤ltet. LÃ¤mna bÃ¥da fÃ¤lten tomma om du
                  inte har nÃ¥gon laddbox. Har du tvÃ¥ laddboxar aktiverar du
                  reglaget **tvÃ¥ laddboxar**
              - features:
                  - type: toggle
                type: tile
                entity: input_boolean.sem_ev_charging_protection_enabled
                features_position: inline
                vertical: false
                icon: mdi:ev-plug-type2
                color: green
                hide_state: true
                name: Urladdningskydd
                tap_action:
                  action: toggle
                icon_tap_action:
                  action: toggle
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_ev_charging_protection_enabled
                    state: "off"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: markdown
                      content: >-
                        **â„¹ï¸Information**

                        Aktivera **urladdningskydd** om du inte vill att
                        batteriet ska ladda elbilen.
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.sem_ev_charging_protection_enabled
                    state: "on"
                card:
                  type: custom:vertical-stack-in-card
                  cards:
                    - type: conditional
                      conditions:
                        - condition: state
                          entity: input_boolean.sem_ev_wallbox_multi
                          state: "off"
                      card:
                        type: entities
                        entities:
                          - entity: input_text.sem_ev_sensor_state
                            name: Laddbox 1
                          - entity: input_text.sem_ev_charging_state
                            name: LaddningslÃ¤ge laddbox 1
                            icon: mdi:format-list-bulleted-square
                          - entity: input_number.sem_battery_discharge_power_ev_limit
                            name: Urladdningseffekt
                    - type: conditional
                      conditions:
                        - condition: state
                          entity: input_boolean.sem_ev_wallbox_multi
                          state: "on"
                      card:
                        type: entities
                        entities:
                          - entity: input_text.sem_ev_sensor_state
                            name: Laddbox 1
                          - entity: input_text.sem_ev_charging_state
                            name: LaddningslÃ¤ge laddbox 1
                            icon: mdi:format-list-bulleted-square
                          - entity: input_text.sem_ev_sensor_state_2
                            name: Laddbox 2
                          - entity: input_text.sem_ev_charging_state_2
                            name: LaddningslÃ¤ge laddbox 2
                            icon: mdi:format-list-bulleted-square
                          - entity: input_number.sem_battery_discharge_power_ev_limit
                    - type: markdown
                      content: >-
                        **â„¹ï¸Information**

                        I **laddboxsensor** anger du vilken sensor som Ã¶vervakar
                        laddboxens aktuella lÃ¤ge (om den laddar eller Ã¤r lÃ¥st).
                        Under **laddningslÃ¤ge** fyller du i det lÃ¤ge som
                        motsvarar nÃ¤r laddboxen faktiskt laddar bilen (t.ex
                        charging). Slutligen anger du under
                        **urladdningseffekt** den effekt (kW) som batteriet ska
                        Ã¥tergÃ¥ till efter att elbilen Ã¤r fÃ¤rdigladdad. 
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: input_boolean.sem_step_3
                    name: Tillbaka
                    icon: mdi:arrow-left
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_4"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_4"
                    features_position: bottom
                  - type: tile
                    entity: input_boolean.sem_step_4
                    name: FortsÃ¤tt
                    icon: mdi:arrow-right
                    color: disabled
                    hide_state: true
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#config_6"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#config_6"
                    features_position: bottom
                columns: 2
              - type: markdown
                content: |
                  <center> 4 av 4 </center>
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#config_6"
            show_header: false
            background_update: false
            width_desktop: 600px
            close_action:
              navigation_path: "#settings"
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: ""
                heading_style: title
                heading: "ğŸ¥³ Konfigurationen Ã¤r klar! "
              - type: markdown
                content: >-
                  **ğŸ’¾ Ã„r det fÃ¶rsta gÃ¥ngen du konfiguerarar systemet?** 

                  DÃ¥ behÃ¶ver systemet **minst sju dagar** att lÃ¤ra sig dina
                  energimÃ¶nster. Under denna tid kan du ladda batteriet manuellt
                  via knappen snabbval i hemvy om det skulle behÃ¶vas.


                  **âš™ï¸ Ã„ndra dina instÃ¤llningar**

                  Detta gÃ¶r du genom att kÃ¶ra om hela konfigurationen. Ã„ndringar
                  startar **INTE** om systemets inlÃ¤rningsprocess pÃ¥ sju dagar. 
              - type: tile
                entity: input_boolean.sem_step_5
                name: Avsluta konfigurationen
                icon: mdi:arrow-right
                color: disabled
                hide_state: true
                vertical: true
                tap_action:
                  action: navigate
                  navigation_path: /lovelace/smart-energy-system
                icon_tap_action:
                  action: navigate
                  navigation_path: /lovelace/smart-energy-system
                features_position: bottom
  - type: grid
    cards:
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#battery"
            show_header: false
          - type: heading
            icon: mdi:home-battery
            heading_style: title
            heading: Batteriet
          - type: custom:vertical-stack-in-card
            cards:
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: sensor.sem_battery_mode
                    name: ArbetslÃ¤ge
                    icon: mdi:auto-mode
                    color: indigo
                    hide_state: false
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    features_position: bottom
                  - type: tile
                    entity: sensor.batteries_charge_discharge_power
                    name: Batteri
                    icon: mdi:battery-charging-100
                    color: indigo
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    features_position: inline
                  - type: tile
                    entity: sensor.batteries_state_of_capacity
                    name: NivÃ¥
                    icon: mdi:battery
                    color: indigo
                    show_entity_picture: false
                    hide_state: false
                    vertical: false
                    tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    icon_tap_action:
                      action: navigate
                      navigation_path: "#battery"
                    features_position: inline
                columns: 3
              - type: entities
                entities:
                  - entity: select.batteries_working_mode
                    name: ArbetslÃ¤ge
                  - entity: number.batteries_maximum_discharging_power
                    name: Max urladdning
                  - entity: number.batteries_grid_charge_maximum_power
                    name: Max laddning
                    icon: mdi:transmission-tower-import
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Alternativen ovan ger dig mÃ¶jlighet att stÃ¤lla in vad
                  batteriet fÃ¥r ladda ur med, men Ã¤ven maximala effekten vid
                  laddning frÃ¥n elnÃ¤tet. Du kan Ã¤ven vÃ¤lja arbetslÃ¤ge pÃ¥ ditt
                  batteri.
                text_only: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:battery-charging-60
                heading: Ladda nu
                heading_style: subtitle
              - type: entities
                entities:
                  - entity: input_number.sem_max_charge_manual_charging
                    name: Laddningseffekt
                    icon: mdi:flash
                  - entity: input_number.sem_manual_charge_duration
                    name: Tid
                    icon: mdi:clock-time-eight
                  - entity: input_boolean.sem_manual_charge
                    icon: mdi:play-circle
                    name: Ladda nu
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  StÃ¤ll in tillÃ¥ten effekt och tid fÃ¶r laddningen. Aktivera
                  laddningen via reglaget **ladda nu**. 
                text_only: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:cog
                heading_style: subtitle
                heading: Aktiverade smarta funktioner
              - type: entities
                entities:
                  - entity: input_boolean.sem_ev_charging_protection_enabled
                    name: Ladda inte elbilen med batteriet
                    icon: mdi:car-electric
                  - entity: input_boolean.sem_discharge_high_prices
                    name: SÃ¤lj Ã¶verskott vid hÃ¶gt elpris
                    icon: mdi:transmission-tower-export
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ovan visas vilka smarta funktioner som Ã¤r **aktiverade i ditt
                  system**. PÃ¥ hemskÃ¤rmens kan du se om den smarta funktionen Ã¤r
                  aktiv. 
                text_only: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:battery-plus
                heading_style: subtitle
                heading: Extra laddning
              - type: entities
                entities:
                  - entity: input_number.extra_1
                    name: Dagen (9-16)
                    icon: mdi:battery-clock
                  - entity: input_number.extra_2
                    name: Natten (23-05)
                    icon: mdi:battery-clock
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Alternativen ovan ger dig mÃ¶jlighet att lÃ¤gga till **extra
                  kwh** pÃ¥ ett laddningstillfÃ¤lle.
                text_only: true
        view_layout:
          position: main
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#grid"
            show_header: false
          - type: heading
            icon: mdi:transmission-tower
            heading_style: title
            heading: ElnÃ¤tet
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:clock
                heading_style: subtitle
                heading: Senaste dygnet
              - type: custom:apexcharts-card
                update_interval: 5 min
                graph_span: 24h
                header:
                  title: Spotpris 48h ink moms
                  show: false
                  show_states: true
                  colorize_states: true
                hours_12: false
                stacked: false
                experimental:
                  color_threshold: true
                yaxis:
                  - id: grid
                    opposite: false
                    show: true
                    decimals: 1
                    apex_config:
                      title:
                        text: kWh
                series:
                  - entity: sensor.sem_export_power_tot
                    type: area
                    yaxis_id: grid
                    name: SÃ¥lt
                    color: green
                    opacity: 0.6
                    color_threshold:
                      - value: 0
                        color: "#ccffcc"
                      - value: 2
                        color: "#66ff66"
                      - value: 5
                        color: "#009900"
                    group_by:
                      func: delta
                      duration: 1h
                    invert: true
                  - entity: sensor.sem_import_power_tot
                    type: area
                    name: KÃ¶pt
                    color: red
                    yaxis_id: grid
                    opacity: 0.6
                    color_threshold:
                      - value: 0
                        color: "#ffcccc"
                      - value: 2
                        color: "#ff6666"
                      - value: 5
                        color: "#cc0000"
                    group_by:
                      func: delta
                      duration: 1h
                apex_config:
                  chart:
                    height: 190px
                    animations:
                      enabled: true
                      easing: easeinout
                      speed: 800
                      animateGradually:
                        enabled: true
                        delay: 150
                  legend:
                    show: true
                    floating: false
                    offsetY: 5
                    position: bottom
                    fontSize: 10px
                  tooltip:
                    enabled: false
                  xaxis:
                    labels:
                      show: true
                      rotate: 0
                      rotateAlways: true
                      logarithmic: false
                  stroke:
                    show: true
                    colors: undefined
                  plotOptions:
                    candlestick:
                      colors:
                        upward: "#00B746"
                        downward: "#EF403C"
                      wick:
                        useFillColor: true
                all_series_config:
                  show:
                    legend_value: false
                    datalabels: false
                    in_brush: false
                  float_precision: 3
                  invert: false
                  fill_raw: last
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:calendar-today
                heading: Idag
                heading_style: subtitle
              - square: false
                type: grid
                cards:
                  - type: tile
                    features_position: bottom
                    vertical: false
                    entity: sensor.sem_import
                    name: KÃ¶pt
                    icon: mdi:transmission-tower-import
                  - type: tile
                    features_position: bottom
                    vertical: false
                    entity: sensor.sem_export
                    icon: mdi:transmission-tower-export
                    name: SÃ¥lt
                columns: 2
          - type: tile
            entity: sensor.sem_nordpool_active
            name: Elpriset
            icon: mdi:flash
            vertical: false
            features_position: bottom
          - type: custom:vertical-stack-in-card
            cards: []
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#solar"
            show_header: false
          - type: heading
            icon: mdi:solar-power-variant
            heading_style: title
            heading: Solceller
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:clock
                heading_style: subtitle
                heading: Senaste dygnet
              - type: custom:apexcharts-card
                update_interval: 5 min
                graph_span: 24h
                header:
                  title: Spotpris 48h ink moms
                  show: false
                  show_states: true
                  colorize_states: true
                hours_12: false
                stacked: false
                experimental:
                  color_threshold: true
                yaxis:
                  - id: solar
                    opposite: false
                    show: true
                    decimals: 1
                    min: 0
                    apex_config:
                      title:
                        text: kWh
                series:
                  - entity: sensor.sem_input_power_with_efficiency_loss_kw_tot
                    type: area
                    yaxis_id: solar
                    name: Producerad solel
                    color: orange
                    stroke_width: 1
                    opacity: 0.6
                    color_threshold:
                      - value: 0
                        color: "#fff066"
                      - value: 2
                        color: "#ffd700"
                      - value: 5
                        color: "#ffb300"
                    group_by:
                      func: delta
                      duration: 1h
                    show:
                      in_legend: true
                  - entity: sensor.sem_consumed_solar_energy_today
                    type: area
                    name: AnvÃ¤nd solel
                    stroke_width: 1
                    opacity: 0.6
                    yaxis_id: solar
                    color: blue
                    color_threshold:
                      - value: 0
                        color: "#cce5ff"
                      - value: 2
                        color: "#3399ff"
                      - value: 5
                        color: "#003366"
                    group_by:
                      duration: 1h
                      func: delta
                apex_config:
                  chart:
                    height: 190px
                    animations:
                      enabled: true
                      easing: easeinout
                      speed: 800
                      animateGradually:
                        enabled: true
                        delay: 150
                  legend:
                    show: true
                    floating: false
                    offsetY: 5
                    position: bottom
                    fontSize: 10px
                  tooltip:
                    enabled: false
                  xaxis:
                    labels:
                      show: true
                      rotate: 0
                      rotateAlways: true
                      logarithmic: false
                  stroke:
                    width: 1
                  plotOptions:
                    candlestick:
                      colors:
                        upward: "#00B746"
                        downward: "#EF403C"
                      wick:
                        useFillColor: true
                  grid:
                    show: true
                    strokeDashArray: 1
                    position: front
                    xaxis:
                      lines:
                        show: false
                all_series_config:
                  show:
                    legend_value: false
                    datalabels: false
                    in_brush: false
                  float_precision: 3
                  invert: false
                  fill_raw: last
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:solar-panel-large
                heading: Idag
                heading_style: subtitle
              - square: false
                type: grid
                cards:
                  - type: tile
                    entity: sensor.sem_solar_production
                    name: Producerat
                    icon: mdi:solar-power-variant
                    vertical: false
                    features_position: bottom
                  - type: tile
                    entity: sensor.sem_consumed_solar_energy_today
                    name: FÃ¶rbrukat
                    icon: mdi:solar-power-variant
                    vertical: false
                    features_position: bottom
                  - type: tile
                    entity: sensor.sem_export
                    name: SÃ¥lt
                    icon: mdi:solar-power-variant
                    vertical: false
                    features_position: bottom
                columns: 3
          - type: custom:vertical-stack-in-card
            cards: []
          - type: custom:vertical-stack-in-card
            cards:
              - type: heading
                icon: mdi:cog
                heading_style: subtitle
                heading: Aktiverade smarta funktioner
              - type: entities
                entities:
                  - entity: input_boolean.sem_export_limit_active
                    name: SÃ¤lj inte solel vid lÃ¥gt elpris
                    icon: mdi:weather-sunny-off
              - type: markdown
                content: >-
                  **â„¹ï¸Information**

                  Ovan visas vilka smarta funktioner som Ã¤r **aktiverade i ditt
                  system**. PÃ¥ hemskÃ¤rmens kan du se om den smarta funktionen Ã¤r
                  aktiv. 
                text_only: true
badges:
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    visibility:
      - condition: state
        entity: input_boolean.sem_export_limit_active
        state: "on"
    entity: input_boolean.sem_max_export_active
    name: BegrÃ¤nsar solexport
    icon: mdi:weather-sunny-off
    tap_action:
      action: none
    color: green
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    visibility:
      - condition: state
        entity: input_boolean.sem_discharge_high_prices
        state: "on"
    entity: input_boolean.sem_discharge
    name: SÃ¤ljer batteriÃ¶verskott
    icon: mdi:battery-negative
    tap_action:
      action: none
    color: green
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    visibility:
      - condition: state
        entity: input_boolean.sem_ev_charging_protection_enabled
        state: "on"
    entity: input_boolean.sem_ev_charging_protection_status
    name: Skydd vid elbilsladdning
    icon: mdi:ev-plug-type2
    color: green
    tap_action:
      action: none
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    entity: timer.sem_manual_charge_time
    name: Manuell laddning
    visibility:
      - condition: state
        entity: input_boolean.sem_manual_charge
        state: "on"
    color: green
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    entity: input_boolean.sem_battery_cheap_mode
    name: VilolÃ¤ge (LÃ¥gt elpris)
    icon: mdi:sleep
    tap_action:
      action: none
    color: green
  - type: entity
    show_name: true
    show_state: true
    show_icon: true
    entity: input_boolean.sem_battery_save
    name: VilolÃ¤ge (Innan pristopp)
    icon: mdi:sleep
    tap_action:
      action: more-info
  - type: entity
    show_name: true
    show_state: true
    show_icon: false
    entity: sensor.sem_update_status
    icon: mdi:database
    tap_action:
      action: navigate
      navigation_path: "#settings"
    name: Mitt system
